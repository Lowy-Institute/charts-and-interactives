extend /partials/layout

block append config
  - var datapath = "static/features/rbo-debate/charts/timeline/"
  - _.extend(page, data.getOne(datapath))
  - toPercent = (n) => (n * 100).toFixed(2) + "%"
  - chart = page
  
  - var cfawcDates = [1991, 2006, 2014, 2018]
  
block page
  .wrapper.flex
    .flex.flex-grow.flex-col
      .chart-title.txt-semi.txt-center= chart.title
      .chart-subtitle.cfawc.txt-tu.txt-cond.txt-center!= chart.subtitle
      .timeline-wrap
        each event in chart.events
          .flex.flex-col.pv-sm
            strong.year(
              class=(event.year==0000 ? "hide" : "pv-sm")
              class=(cfawcDates.includes(event.year) ? "cfawc" : "")
            )!= event.year
            if event.year != 2006 && event.year != 2018
              .event-wrap.flex
                .event.txt-semi!= event.event
                .impact.txt-semi.italic!= event.impact
        
  
block append css
  style
    :sass
    
      html
        height: auto
        overflow: visible
    
      $red: #b90000
  
      li
        list-style-type: none
        
      ul
        margin-bottom: 0
        padding-left: 0
  
      .wrapper
        // height: 550px
        max-width: 700px
        // overflow-y: scroll
        scrollbar-width: thin
        &::-webkit-scrollbar
          width: 5px
        &::-webkit-scrollbar-track
          border-radius: 50%

      .chart-title
        margin: auto
        font-size: 28px
        color: black
        
      .chart-subtitle
        margin: 5px auto 22px
        font-weight: 600
        font-size: 16px
        color: $red

      .timeline-wrap
        border-left: 1px solid $red
        border-top: 1px solid $red
        padding-left: 20px
        margin-left: 10px
        
        > .flex:last-child
          padding-bottom: 0
          .year
            padding-bottom: 0
        
        &:before
          content: ''
          position: absolute
          left: 50%
          width: 0
          height: 0
          border-top: 7px solid transparent
          border-bottom: 7px solid transparent
          border-right: 10px solid $red
          margin-top: -7.5px
          box-shadow: 0 0 0 2px white

      .year
        color: $red
        
      .year:before,
      .cfawc:before
        content: ''
        position: absolute
        width: 12px
        height: 12px
        margin-left: -26px
        margin-top: 6px
        background: $red
        border-radius: 50%
        box-shadow: 0 0 0 2px white
      
      .cfawc:before
        background: $red
        box-shadow: 0 0 0 2px $red
        border: 2px solid white
        margin-top: 4px
        margin-left: -28.5px
        
      .cfawc.chart-subtitle:before
        margin-left: -22px
        height: 10px
        width: 10px
        margin-top: 4px
        
      .event
        color: black
        
      .impact
        margin-left: 1.5em
        &:before
          content: 'Reaction: '
          
        
      .flex > .event
        flex: 0.8
      .flex > .impact
        flex: 1
        
      .hide
        opacity: 0
        height: 0
    
      @media (max-width: 767px)
        body
          font-size: 17px
        
      @media (max-width: 500px)
        .event-wrap
          flex-direction: column
        .impact
          align-self: baseline
          margin-left: 0
          margin-top: 8px
          font-style: italic
