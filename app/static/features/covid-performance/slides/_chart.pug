- scalex = [ 13, 209 ]
- scaley = [  0, 100 ]
- rangex = scalex[1] - scalex[0]
- rangey = scaley[1] - scaley[0]

if cat
  - labels = data.getOne(`static/features/covid-performance/data/${cat}`).labels
  - values = data.getOne(`static/features/covid-performance/data/${cat}`).values
  - colors = data.getOne(`static/features/covid-performance/data/${cat}`).colors
      
.chart-wrap
  
  .chart-body(data-view="in-viewport")
    
    svg(
      width="100%"
      height="100%"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
    )
      
      // X TICKS
      svg(width="100%" height="100%")
        for n, i in new Array(rangex)
          if (i % 14 == 0 || i == rangex-1)
            - x = i / rangex * 100 + "%"
            g.fade-in(class=("delay-" + ~~(i * 3 / 40)))
              rect.fill-v(x=x width=2 y=0 height="100%")
              g
                rect.fill-dark(
                  x=x
                  y="100%"
                  transform="translate(-30 -16)"
                  width=60 height=32
                )
                text.fade.fill-fff(
                  x=x
                  y="100%"
                  text-anchor="middle"
                  transform="translate(0 7)"
                )
                  = ((scalex[0] + i + 1) / 7).toFixed(0)
                  
      // Y TICKS
      svg(width="100%" height="100%")
        - steps = 6
        for n, i in new Array(steps)
          if i > 0 && i < steps-1
            - y = (i) / (steps-1) * 100 + "%"
            g.fade-in(class=("delay-" + i * 2))
              rect.fill-h.fill-fff.fill-a(
                x=0
                y=y
                width="100%"
                height=2
              )

              g
                rect.fill-dark(
                  x="50%"
                  y=y
                  transform="translate(-40 -22)"
                  width=80 height=44
                )
                text.fade.fill-fff(
                  x="50%"
                  y=y
                  text-anchor="middle"
                  transform="translate(0 7)"
                )
                  | #{20 * i}%


    if cat
      .absolute.inset-0
        include _line
    
    .chart-labels
  
      .x.txt-mid.fade-in Weeks after 100th case
        svg.inline(width='100', height='10', xmlns='http://www.w3.org/2000/svg')
          path.fill-l2r(d='M.25 3.5l85.93-.02V-.07l13.8 5.5-13.53 4.55V6.76H.52L.25 3.5z')
          
      .y.txt-mid.fade-in.flex

        svg(width='100', height='10', xmlns='http://www.w3.org/2000/svg')
          path.fill-r2l(d='M 100 3.5 l -45 0 V -.07 l -13 5 13 5 V 6.76 H 100 z')
          text.fill-mid(x="32" y="82.5%" text-anchor="end") Better
          
        .ph-xs COVID performance

        svg(width='100', height='10', xmlns='http://www.w3.org/2000/svg')
          path.fill-l2r(d='M 0 3.5 l 45 0 V -.07 l 13 5 -13 5 V 6.76 H 0 z')
          text.fill-mid(x="68" y="82.5%" text-anchor="start") Worse

    if cat == null
      include _countries
      #tooltip
